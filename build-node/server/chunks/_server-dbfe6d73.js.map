{"version":3,"file":"_server-dbfe6d73.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/(api)/api/instagram/_server.js"],"sourcesContent":["import { j as json } from \"../../../../../chunks/index.js\";\nimport { log } from \"console\";\nasync function GET({ fetch }) {\n  let data = null;\n  try {\n    data = await fetch(\"../uploads/fulldata.json\").then((res) => res.json()).catch((err) => null);\n  } catch (error) {\n    log(\"Error loading instagram data\", error);\n  }\n  if (!data)\n    return new Response(\n      JSON.stringify({ type: \"failure\", errorMsg: \"Impossible de charger les données\" }),\n      { status: 400 }\n    );\n  const { xdt_api__v1__feed__user_timeline_graphql_connection, last_update = null } = data;\n  if (xdt_api__v1__feed__user_timeline_graphql_connection == null)\n    return new Response(\n      JSON.stringify({ type: \"failure\", errorMsg: \"Impossible de charger les données\" }),\n      { status: 400 }\n    );\n  const { edges } = xdt_api__v1__feed__user_timeline_graphql_connection;\n  if (edges == null || !Array.isArray(edges))\n    return new Response(\n      JSON.stringify({ type: \"failure\", errorMsg: \"Impossible de charger les données\" }),\n      { status: 400 }\n    );\n  let finalData = {\n    type: \"success\",\n    last_update,\n    publish: []\n  };\n  try {\n    for (const edge of edges) {\n      const { node } = edge;\n      const localdata = {};\n      localdata.like_count = node.like_count;\n      localdata.titre = node.caption?.text;\n      localdata.date = node.taken_at;\n      localdata.cover = node.image_versions2;\n      localdata.video = node.video_versions;\n      if (node.image_versions2 != null && node.image_versions2.candidates != null && Object.keys(node.image_versions2.candidates).length > 0)\n        localdata.cover = node.image_versions2.candidates[0];\n      if (node.video_versions != null && Object.keys(node.video_versions).length > 0)\n        localdata.video = node.video_versions[0];\n      localdata.location = node.location?.name;\n      finalData.publish.push(localdata);\n    }\n  } catch (error) {\n    log(\"Error parsing instagram data\", error);\n  }\n  if (finalData.publish.length <= 0)\n    return new Response(\n      JSON.stringify({ type: \"failure\", errorMsg: \"Impossible de charger les données\" }),\n      { status: 400 }\n    );\n  return json(finalData);\n}\nexport {\n  GET\n};\n"],"names":[],"mappings":"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"}